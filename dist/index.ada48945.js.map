{"mappings":"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","sources":["modules/globals.js","modules/layoutExtractor.js","modules/navInteraction.js","modules/keyboardInteraction.js","main.js"],"sourcesContent":["// DOM ELEMENT VARIABLES\r\nconst DOM = {\r\n  layoutForm: document.querySelector(\"#layout-form\"),\r\n  layoutFormSubmit: document.querySelector(\"#layout-submit\"),\r\n  viewSwitcher: document.querySelector(\"#view-switcher\"),\r\n  layerNav: document.querySelector(\"#layer-nav\"),\r\n  keyboard: document.querySelector(\"#keyboard\"),\r\n};\r\n\r\n// GLOBAL VARIABLES\r\nconst Store = {\r\n  data: {},\r\n  layers: [],\r\n  layerStack: [],\r\n  getCurrLayer() {\r\n    return this.layerStack[this.layerStack.length - 1];\r\n  },\r\n  toLocalStorage(lData) {\r\n    localStorage.setItem(\"KBLayoutData\", JSON.stringify(lData));\r\n  },\r\n  fromLocalStorage() {\r\n    return JSON.parse(localStorage.getItem(\"KBLayoutData\"));\r\n  },\r\n  localStorageExists() {\r\n    return this.fromLocalStorage() !== null;\r\n  },\r\n};\r\n\r\nexport { DOM, Store };\r\n","export const Extract = {\r\n  layoutData(src) {\r\n    const srcLayers = src.split(/(?<=')$/m);\r\n    let extracted = {};\r\n\r\n    for (i in srcLayers) {\r\n      // iterate over Layers\r\n      let name = extractLayerName(srcLayers[i]);\r\n      let rows = extractRows(srcLayers[i]);\r\n\r\n      let keys = rows.map((row, i) => {\r\n        //iterate over rows\r\n        if (i === 3) {\r\n          return extractKeys(row, 6);\r\n        } else {\r\n          return extractKeys(row);\r\n        }\r\n      });\r\n\r\n      extracted[name] = keys;\r\n    }\r\n\r\n    return extracted;\r\n  },\r\n  layerNames(src) {\r\n    return Object.keys(src).map((lName) => {\r\n      return lName;\r\n    });\r\n  },\r\n};\r\n\r\n// INTERNAL\r\nfunction extractLayerName(layer) {\r\n  return layer.match(/^\\w+$/m)[0];\r\n}\r\nfunction extractRows(layer) {\r\n  return layer.match(/^\\|[^\\-].+$/gm);\r\n}\r\nfunction extractKeys(row, twoUKeyAt) {\r\n  let rowCleaned = row.replace(/((?<=\\|)\\s\\|)|(^\\|)|(\\|$)/g, \"\");\r\n  let keys = rowCleaned.match(/.{1,8}/g);\r\n\r\n  let keysTwoUsMerged = [];\r\n  for (let i = 0; i < keys.length; i++) {\r\n    if (i == twoUKeyAt) {\r\n      keysTwoUsMerged.push(`${keys[i]}${keys[i + 1]}`);\r\n      i++;\r\n    } else {\r\n      keysTwoUsMerged.push(keys[i]);\r\n    }\r\n  }\r\n\r\n  let keysCleaned = keysTwoUsMerged.map((key) => {\r\n    return key.slice(0, -1);\r\n  });\r\n\r\n  return keysCleaned;\r\n}\r\n","import { Store, DOM } from \"./globals\";\r\nimport { Keys } from \"./keyboardInteraction\";\r\n\r\nconst Nav = {\r\n  addLayer(layerName) {\r\n    Store.layerStack.push(layerName);\r\n\r\n    let btnDOM = document.createElement(\"button\");\r\n    btnDOM.innerHTML = layerName;\r\n    btnDOM.classList.add(\"layer-btn\");\r\n    btnDOM.id = layerName;\r\n    btnDOM.onclick = () => {\r\n      this.clicked(layerName);\r\n    };\r\n\r\n    DOM.layerNav.appendChild(btnDOM);\r\n  },\r\n  removeLayer(layerName) {\r\n    Store.layerStack.pop();\r\n\r\n    let layerToRemove = document.getElementById(layerName);\r\n    layerToRemove.remove();\r\n  },\r\n  clicked(targetLayerName) {\r\n    if (targetLayerName == Store.getCurrLayer()) {\r\n      if (Store.layerStack.length > 1) {\r\n        const activeLayer = Store.getCurrLayer();\r\n        this.removeLayer(activeLayer);\r\n        const newActiveLayer = Store.getCurrLayer();\r\n        Keys.renderLayer(newActiveLayer);\r\n      }\r\n    } else {\r\n      let currL = Store.getCurrLayer();\r\n      while (currL !== targetLayerName) {\r\n        this.removeLayer(currL);\r\n        currL = Store.getCurrLayer();\r\n      }\r\n\r\n      Keys.renderLayer(targetLayerName);\r\n    }\r\n  },\r\n};\r\n\r\nexport { Nav };\r\n","import { Store } from \"./globals\";\r\nimport { Nav } from \"./navInteraction\";\r\n\r\nconst Keys = {\r\n  renderLayer(layerName) {\r\n    let layerData = Store.data[layerName];\r\n\r\n    this.forAll(layerName, (id, r, c) => {\r\n      let keyData = layerData[r][c];\r\n      const keyDOM = document.getElementById(id);\r\n\r\n      keyDOM.classList.remove(\"pressed\");\r\n\r\n      if (keyData.match(/^(\\s+)?_+(\\s+)?$/m)) {\r\n        Key.addFade(id);\r\n        Key.setContent(id, \"\");\r\n      } else {\r\n        Key.removeFade(id);\r\n        if (Key.getTargetLayer(keyData) === Store.getCurrLayer()) {\r\n          Key.setContent(id, Key.removeSquareBrackets(keyData));\r\n          keyDOM.classList.add(\"pressed\");\r\n        } else {\r\n          Key.setContent(id, keyData);\r\n        }\r\n      }\r\n    });\r\n\r\n    this.updateInteractivity();\r\n  },\r\n  updateInteractivity() {\r\n    const currLayer = Store.getCurrLayer();\r\n\r\n    this.forAll(currLayer, (id) => {\r\n      let keyName = Key.getContent(id);\r\n\r\n      if (hasLayerInName(keyName)) {\r\n        Key.makeInteractive(id);\r\n      } else {\r\n        Key.removeInteractivity(id);\r\n      }\r\n    });\r\n  },\r\n  forAll(layerName, callback) {\r\n    l = Store.data[layerName];\r\n    for (row in l) {\r\n      for (col in l[row]) {\r\n        const id = `${row}x${col}`;\r\n        callback(id, row, col);\r\n      }\r\n    }\r\n  },\r\n};\r\n\r\nconst Key = {\r\n  setContent(id, val) {\r\n    let span = document.getElementById(id).getElementsByTagName(\"span\")[0];\r\n    span.innerHTML = val;\r\n  },\r\n  getContent(id) {\r\n    let span = document.getElementById(id).getElementsByTagName(\"span\")[0];\r\n    return span.innerHTML;\r\n  },\r\n  getTargetLayer(keyName) {\r\n    return Store.layers.find((l) => {\r\n      return keyName.includes(l);\r\n    });\r\n  },\r\n  makeInteractive(id) {\r\n    let keyDOM = document.getElementById(id);\r\n\r\n    keyDOM.onclick = () => {\r\n      this.clicked(id);\r\n    };\r\n    keyDOM.classList.add(\"clickeable\");\r\n  },\r\n  removeInteractivity(id) {\r\n    let keyDOM = document.getElementById(id);\r\n\r\n    keyDOM.onclick = null;\r\n    keyDOM.classList.remove(\"clickeable\");\r\n  },\r\n  clicked(id) {\r\n    const keyName = this.getContent(id);\r\n    let targetLayer = this.getTargetLayer(keyName);\r\n\r\n    if (targetLayer == Store.getCurrLayer()) {\r\n      const activeLayer = Store.getCurrLayer();\r\n      Nav.removeLayer(activeLayer);\r\n      const newActiveLayer = Store.getCurrLayer();\r\n      Keys.renderLayer(newActiveLayer);\r\n    } else {\r\n      Nav.addLayer(targetLayer);\r\n      Keys.renderLayer(targetLayer);\r\n    }\r\n  },\r\n  addFade(id) {\r\n    let keyDOM = document.getElementById(id);\r\n\r\n    keyDOM.classList.add(\"faded\");\r\n  },\r\n  removeFade(id) {\r\n    let keyDOM = document.getElementById(id);\r\n\r\n    keyDOM.classList.remove(\"faded\");\r\n  },\r\n  removeSquareBrackets(keyName) {\r\n    const newName = keyName.replaceAll(/(^\\[\\s?)|(\\s?\\]$)/gm, \"\");\r\n    return newName;\r\n  },\r\n};\r\n\r\nfunction hasLayerInName(keyName) {\r\n  return Store.layers.some((l) => {\r\n    return keyName.includes(l);\r\n  });\r\n}\r\n\r\nexport { Keys, Key };\r\n","import { DOM, Store } from \"./modules/globals\";\r\nimport { Extract } from \"./modules/layoutExtractor\";\r\nimport { Keys } from \"./modules/keyboardInteraction\";\r\nimport { Nav } from \"./modules/navInteraction\";\r\n\r\nfunction readLayout() {\r\n  const srcText = DOM.layoutForm.querySelector(\"textarea\").value;\r\n  Store.data = Extract.layoutData(srcText);\r\n  Store.layers = Extract.layerNames(Store.data);\r\n\r\n  switchToKeyboardView();\r\n  if (Store.layerStack.length == 0) {\r\n    Nav.addLayer(\"MAIN\");\r\n  }\r\n\r\n  Keys.renderLayer(\"MAIN\");\r\n\r\n  Store.toLocalStorage(Store.data);\r\n}\r\n\r\n// VIEWPORT FUNCTIONS\r\nfunction switchToFormView() {\r\n  console.log(\"going to form view...\");\r\n  DOM.keyboard.style.display = \"none\";\r\n  DOM.layerNav.style.display = \"none\";\r\n  DOM.viewSwitcher.style.display = \"none\";\r\n  DOM.layoutForm.style.removeProperty(\"display\");\r\n}\r\nfunction switchToKeyboardView() {\r\n  console.log(\"going to keyboard view...\");\r\n  DOM.layoutForm.style.display = \"none\";\r\n  DOM.keyboard.style.removeProperty(\"display\");\r\n  DOM.layerNav.style.removeProperty(\"display\");\r\n  DOM.viewSwitcher.style.removeProperty(\"display\");\r\n}\r\n\r\n// [[ SETUP ]]\r\nif (Store.localStorageExists()) {\r\n  Store.data = Store.fromLocalStorage();\r\n  Store.layers = Extract.layerNames(Store.data);\r\n  switchToKeyboardView();\r\n  Nav.addLayer(\"MAIN\");\r\n  Keys.renderLayer(\"MAIN\");\r\n} else {\r\n  switchToFormView();\r\n}\r\n\r\nDOM.layoutFormSubmit.addEventListener(\"click\", readLayout);\r\nDOM.viewSwitcher.addEventListener(\"click\", switchToFormView);\r\n"],"names":["$b19829655c47a9e3$export$cb0933279c36a66b","layoutForm","document","querySelector","layoutFormSubmit","viewSwitcher","layerNav","keyboard","$b19829655c47a9e3$export$390f32400eaf98c9","data","layers","layerStack","getCurrLayer","this","length","toLocalStorage","lData","localStorage","setItem","JSON","stringify","fromLocalStorage","parse","getItem","localStorageExists","$2cfd2f0f22a1ae6a$export$296daa4fd2384194","src","srcLayers","split","RegExp","extracted","i","name","match","keys","$2cfd2f0f22a1ae6a$var$extractRows","map","row","$2cfd2f0f22a1ae6a$var$extractKeys","Object","lName","layer","twoUKeyAt","replace","keysTwoUsMerged","push","concat","key","slice","$e3a6dec024d85894$export$39140c7d8b0ba7b3","addLayer","layerName","btnDOM","createElement","innerHTML","classList","add","id","onclick","_this","clicked","appendChild","removeLayer","pop","getElementById","remove","targetLayerName","activeLayer","newActiveLayer","$74e8a5794e7b5e51$export$4b0075e5ea5e1f26","renderLayer","currL","layerData","forAll","r","c","keyData","keyDOM","$74e8a5794e7b5e51$export$cd0f44441c3b7719","addFade","setContent","removeFade","getTargetLayer","removeSquareBrackets","updateInteractivity","currLayer","keyName","some","l","includes","$74e8a5794e7b5e51$var$hasLayerInName","getContent","removeInteractivity","makeInteractive","callback","col","val","getElementsByTagName","find","targetLayer","replaceAll","$93b772d14b13910f$var$switchToFormView","console","log","style","display","removeProperty","$93b772d14b13910f$var$switchToKeyboardView","addEventListener","srcText","value"],"version":3,"file":"index.ada48945.js.map"}